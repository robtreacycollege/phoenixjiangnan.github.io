<!doctype html>



  


<html class="theme-next muse use-motion">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>



<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />












  
  
  <link href="/vendors/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/vendors/font-awesome/css/font-awesome.min.css?v=4.4.0" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.0.1" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="Hexo, welcome to Bowen's blog" />





  <link rel="alternate" href="/atom.xml" title="Bowen's blog" type="application/atom+xml" />




  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.0.1" />






<meta name="description" content="keep learning - learning notes and blogs">
<meta property="og:type" content="website">
<meta property="og:title" content="Bowen's blog">
<meta property="og:url" content="https://phoenixjiangnan.github.io/page/3/index.html">
<meta property="og:site_name" content="Bowen's blog">
<meta property="og:description" content="keep learning - learning notes and blogs">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Bowen's blog">
<meta name="twitter:description" content="keep learning - learning notes and blogs">



<script type="text/javascript" id="hexo.configuration">
  var NexT = window.NexT || {};
  var CONFIG = {
    scheme: 'Muse',
    sidebar: {"position":"left","display":"post"},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: 0,
      author: 'Author'
    }
  };
</script>




  <link rel="canonical" href="https://phoenixjiangnan.github.io/page/3/"/>

  <title> Bowen's blog </title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="en">

  










  
  
    
  

  <div class="container one-collumn sidebar-position-left 
   page-home 
 ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-meta ">
  

  <div class="custom-logo-site-title">
    <a href="/"  class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <span class="site-title">Bowen's blog</span>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>
  <p class="site-subtitle">keep learning - learning notes and blogs</p>
</div>



<div class="site-nav-toggle">
  <button>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
  </button>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            Home
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="https://phoenixjiangnan.github.io/about" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            About
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="https://phoenixjiangnan.github.io/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            Archives
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="https://phoenixjiangnan.github.io/categories" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            Categories
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="https://phoenixjiangnan.github.io/tags" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            Tags
          </a>
        </li>
      

      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br />
            
            Search
          </a>
        </li>
      
    </ul>
  

  
    <div class="site-search">
      
  <div class="popup">
 <span class="search-icon fa fa-search"></span>
 <input type="text" id="local-search-input">
 <div id="local-search-result"></div>
 <span class="popup-btn-close">close</span>
</div>


    </div>
  
</nav>

 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/06/21/ruby/Ruby-Methods-in-Ruby/" itemprop="url">
                  Ruby - Methods in Ruby
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">Posted on</span>
            <time itemprop="dateCreated" datetime="2016-06-21T23:54:37+08:00" content="2016-06-21">
              2016-06-21
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">In</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/ruby/" itemprop="url" rel="index">
                    <span itemprop="name">ruby</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2016/06/21/ruby/Ruby-Methods-in-Ruby/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2016/06/21/ruby/Ruby-Methods-in-Ruby/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          <h1 id="Member-Functions-in-Ruby-Class"><a href="#Member-Functions-in-Ruby-Class" class="headerlink" title="Member Functions in Ruby Class"></a>Member Functions in Ruby Class</h1><p>In Ruby, functions are called <code>methods</code>. Each method in a class starts with the keyword def followed by the method name.</p>
<p>The method name always preferred in lowercase letters. You end a method in Ruby by using the keyword <code>end</code>.</p>
<p>Here is the example to define a Ruby method:</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Sample</span></span></div><div class="line">   <span class="function"><span class="keyword">def</span> <span class="title">function</span></span></div><div class="line">      statement</div><div class="line">   <span class="keyword">end</span></div><div class="line"><span class="keyword">end</span></div></pre></td></tr></table></figure>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Sample</span></span></div><div class="line">   <span class="function"><span class="keyword">def</span> <span class="title">hello</span></span></div><div class="line">      puts <span class="string">"Hello Ruby!"</span></div><div class="line">   <span class="keyword">end</span></div><div class="line"><span class="keyword">end</span></div></pre></td></tr></table></figure>
<h2 id="Ruby-Methods"><a href="#Ruby-Methods" class="headerlink" title="Ruby Methods"></a>Ruby Methods</h2><p>Methods should be defined before calling them, otherwise Ruby will raise an exception for undefined method invoking.</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">method_name</span> </span></div><div class="line">   expr..</div><div class="line"><span class="keyword">end</span></div></pre></td></tr></table></figure>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">method_name</span> <span class="params">(var1, var2)</span></span></div><div class="line">   expr..</div><div class="line"><span class="keyword">end</span></div></pre></td></tr></table></figure>
<h2 id="Default-Arguments"><a href="#Default-Arguments" class="headerlink" title="Default Arguments"></a>Default Arguments</h2><figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># var1's default value is value1, if it's missing</span></div><div class="line"><span class="comment"># var2's default value is value2, if it's missing</span></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">method_name</span> <span class="params">(var1=value1, var2=value2)</span></span></div><div class="line">   expr..</div><div class="line"><span class="keyword">end</span></div></pre></td></tr></table></figure>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">test</span><span class="params">(arg1=<span class="string">"Ruby"</span>, arg2=<span class="string">"Perl"</span>)</span></span></div><div class="line">   puts <span class="string">"The programming language is <span class="subst">#&#123;arg1&#125;</span>"</span></div><div class="line">   puts <span class="string">"The programming language is <span class="subst">#&#123;arg2&#125;</span>"</span></div><div class="line"><span class="keyword">end</span></div><div class="line"></div><div class="line">test <span class="string">"C"</span>, <span class="string">"C++"</span></div><div class="line">test</div></pre></td></tr></table></figure>
<p>Output:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">The programming language is C</div><div class="line">The programming language is C++</div><div class="line">The programming language is Ruby</div><div class="line">The programming language is Perl</div></pre></td></tr></table></figure>
          <div class="post-more-link text-center">
            <a class="btn" href="/2016/06/21/ruby/Ruby-Methods-in-Ruby/#more" rel="contents">
              Read more &raquo;
            </a>
          </div>
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/06/21/ruby/Ruby-Variables-in-Ruby/" itemprop="url">
                  Ruby - Variables and Constant in Ruby
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">Posted on</span>
            <time itemprop="dateCreated" datetime="2016-06-21T22:49:27+08:00" content="2016-06-21">
              2016-06-21
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">In</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/ruby/" itemprop="url" rel="index">
                    <span itemprop="name">ruby</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2016/06/21/ruby/Ruby-Variables-in-Ruby/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2016/06/21/ruby/Ruby-Variables-in-Ruby/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          <h1 id="Ruby-Variables"><a href="#Ruby-Variables" class="headerlink" title="Ruby Variables"></a>Ruby Variables</h1><p>Ruby provides five types of variables:</p>
<ul>
<li><code>Local Variables</code>: variables defined in a method. Local variables are not available outside the method. You will see more details about method in subsequent chapter. Local variables begin with <code>a lowercase letter</code> or <code>_</code>.</li>
<li><code>Instance Variables</code>: variables available across methods for any particular instance or object. That means that instance variables change from object to object. Instance variables are preceded by the at sign <code>@</code> followed by the variable name.</li>
<li><code>Class Variables</code>: variables available across different objects. A class variable belongs to the class and is a characteristic of a class. They are preceded by the sign <code>@@</code> and are followed by the variable name.</li>
<li><code>Global Variables</code>: Class variables are not available across classes. If you want to have a single variable, which is available across classes, you need to define a global variable. The global variables are always preceded by the dollar sign <code>$</code>.</li>
</ul>
          <div class="post-more-link text-center">
            <a class="btn" href="/2016/06/21/ruby/Ruby-Variables-in-Ruby/#more" rel="contents">
              Read more &raquo;
            </a>
          </div>
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/06/20/ruby/Ruby-attr-accessor-attr-reader-and-attr-writer/" itemprop="url">
                  Ruby - attr_accessor, attr_reader, and attr_writer
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">Posted on</span>
            <time itemprop="dateCreated" datetime="2016-06-20T22:26:46+08:00" content="2016-06-20">
              2016-06-20
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">In</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/ruby/" itemprop="url" rel="index">
                    <span itemprop="name">ruby</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2016/06/20/ruby/Ruby-attr-accessor-attr-reader-and-attr-writer/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2016/06/20/ruby/Ruby-attr-accessor-attr-reader-and-attr-writer/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          <p>Recently, I started working on Ruby and JRuby. Good to start posting some tutorials. </p>
<p>You may use the different accessors to communicate your intent to someone reading your code, and make it easier to write classes which will work correctly no matter how their public API is called.</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span></span></div><div class="line">  <span class="keyword">attr_accessor</span> <span class="symbol">:age</span></div><div class="line">  </div><div class="line">  ...</div><div class="line"><span class="keyword">end</span></div></pre></td></tr></table></figure>
<p>Here, I can see that I may both read and write the age.</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span></span></div><div class="line">  <span class="keyword">attr_reader</span> <span class="symbol">:age</span></div><div class="line">  </div><div class="line">  ...</div><div class="line"><span class="keyword">end</span></div></pre></td></tr></table></figure>
          <div class="post-more-link text-center">
            <a class="btn" href="/2016/06/20/ruby/Ruby-attr-accessor-attr-reader-and-attr-writer/#more" rel="contents">
              Read more &raquo;
            </a>
          </div>
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/06/17/system design/task queue/System-Design-How-to-query-status-of-10-000-machines/" itemprop="url">
                  System Design - How to query status of 10,000 machines
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">Posted on</span>
            <time itemprop="dateCreated" datetime="2016-06-17T11:16:19+08:00" content="2016-06-17">
              2016-06-17
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">In</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/system-design/" itemprop="url" rel="index">
                    <span itemprop="name">system design</span>
                  </a>
                </span>

                
                
                  , 
                

              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/system-design/task-queue/" itemprop="url" rel="index">
                    <span itemprop="name">task queue</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2016/06/17/system design/task queue/System-Design-How-to-query-status-of-10-000-machines/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2016/06/17/system design/task queue/System-Design-How-to-query-status-of-10-000-machines/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          <p>As promised in <a href="https://phoenixjiangnan.github.io/2016/07/01/system%20design/task%20queue/System-Design-Design-Task-Scheduling-System-in-Distributed-System/">https://phoenixjiangnan.github.io/2016/07/01/system%20design/task%20queue/System-Design-Design-Task-Scheduling-System-in-Distributed-System/</a>, I’m writing my experience and thoughts on that problem, which I got interviewed with Palantir 2 years ago.</p>
<p>To refresh your thoughts, the problem we are trying so solve looks like this.</p>
<blockquote>
<p>How to retrieve 10,000 machines’ health status (can be as simple as live or dead, or as complicated as checking a service is functioning or not) and show all status on a web UI.</p>
</blockquote>
<p>This is a pretty practical problem, just imagine how you see your EC2 machines’ status on AWS console.</p>
<p>The general answer is to 1) maintain a queue of 10,000 jobs, each one is to query a machine’s status 2) have a bunch of worker machines run in parallel, retrieving and executing one status querying job at a time.</p>
<p>Following are the steps of getting deeper in this question and ultimately reach a satisfying state.</p>
<h2 id="Step-1-Naive-Approach"><a href="#Step-1-Naive-Approach" class="headerlink" title="Step 1 - Naive Approach"></a>Step 1 - Naive Approach</h2><p>A pitfall when the interviewer presents this question is that, he won’t tell you how many machines you can use to do such an operation. Thus, the first impression an inteviewee got is it can be a dead simple a loop.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="function">List&lt;Status&gt; <span class="title">getStatus</span><span class="params">(List&lt;Host&gt; hosts)</span> </span>&#123;</div><div class="line">    List&lt;Status&gt; status = Lists.newArrayList();</div><div class="line">    hosts.forEach(h -&gt; &#123;</div><div class="line">        status.add(h.getStatus());</div><div class="line">    &#125;)</div><div class="line">    </div><div class="line">    <span class="keyword">return</span> status;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
          <div class="post-more-link text-center">
            <a class="btn" href="/2016/06/17/system design/task queue/System-Design-How-to-query-status-of-10-000-machines/#more" rel="contents">
              Read more &raquo;
            </a>
          </div>
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/06/16/java/reflection/Java-Reflection-and-the-Class-Objects/" itemprop="url">
                  Java Reflection and the Class Objects
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">Posted on</span>
            <time itemprop="dateCreated" datetime="2016-06-16T12:00:45+08:00" content="2016-06-16">
              2016-06-16
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">In</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/java/" itemprop="url" rel="index">
                    <span itemprop="name">java</span>
                  </a>
                </span>

                
                
                  , 
                

              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/java/reflection/" itemprop="url" rel="index">
                    <span itemprop="name">reflection</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2016/06/16/java/reflection/Java-Reflection-and-the-Class-Objects/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2016/06/16/java/reflection/Java-Reflection-and-the-Class-Objects/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          <h1 id="What-is-Reflection"><a href="#What-is-Reflection" class="headerlink" title="What is Reflection"></a>What is Reflection</h1><p>Java Reflection makes it possible to inspect classes, interfaces, fields and methods at runtime, without knowing the names of the classes, methods etc. at compile time. It is also possible to instantiate new objects, invoke methods and get/set field values using reflection.</p>
<h1 id="Uses-of-Reflection"><a href="#Uses-of-Reflection" class="headerlink" title="Uses of Reflection"></a>Uses of Reflection</h1><p>Reflection is commonly used by programs which require the ability to examine or modify the runtime behavior of applications running in the Java virtual machine. This is a relatively advanced feature and should be used only by developers who have a strong grasp of the fundamentals of the language. With that caveat in mind, reflection is a powerful technique and can enable applications to perform operations which would otherwise be impossible.</p>
<p>Using Java Reflection you can inspect Java classes <code>at runtime</code>. Inspecting classes is often the first thing you do when using Reflection. From the classes you can obtain information about</p>
<ul>
<li>Class Name</li>
<li>Class Modifies (public, private, synchronized etc.)</li>
<li>Package Info</li>
<li>Superclass</li>
<li>Implemented Interfaces</li>
<li>Constructors</li>
<li>Methods</li>
<li>Fields</li>
<li>Annotations</li>
</ul>
          <div class="post-more-link text-center">
            <a class="btn" href="/2016/06/16/java/reflection/Java-Reflection-and-the-Class-Objects/#more" rel="contents">
              Read more &raquo;
            </a>
          </div>
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/06/11/web development/Web-Development-TCP-Transportation/" itemprop="url">
                  Web Development - TCP Transportation
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">Posted on</span>
            <time itemprop="dateCreated" datetime="2016-06-11T20:39:49+08:00" content="2016-06-11">
              2016-06-11
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">In</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/web-development/" itemprop="url" rel="index">
                    <span itemprop="name">web development</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2016/06/11/web development/Web-Development-TCP-Transportation/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2016/06/11/web development/Web-Development-TCP-Transportation/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>This is a blog about TCP and how to implement TCP. The content is from some of my academic courses, and my personal project.</p>
<p>I want to post it here for quick reference in the future - Obviously not a whole lot developers use TCP on a daily basis.</p>
<h2 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h2><p>The <code>Transmission Control Protocol (TCP)</code> is a core protocol of the Internet protocol suite.</p>
<p>It originated in the initial network implementation in which it complemented the <code>Internet Protocol (IP)</code>. Therefore, the entire suite is commonly referred to as <code>TCP/IP</code>. </p>
<p>TCP provides <code>reliable</code>, <code>ordered</code>, and <code>error-checked</code> delivery of a stream of octets between applications running on hosts communicating over an IP network.</p>
<p>Major Internet applications such as the World Wide Web, email, remote administration and file transfer rely on TCP. Applications that do not require reliable data stream service may use the <code>User Datagram Protocol (UDP)</code>, which provides a connectionless datagram service that emphasizes reduced latency over reliability.</p>
<h2 id="Socket-and-ServerSocket"><a href="#Socket-and-ServerSocket" class="headerlink" title="Socket and ServerSocket"></a>Socket and ServerSocket</h2><p><a href="https://docs.oracle.com/javase/8/docs/api/java/net/Socket.html" target="_blank" rel="external">Socket</a> class:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Socket</span></span></div><div class="line"><span class="keyword">extends</span> <span class="title">Object</span></div><div class="line"><span class="keyword">implements</span> <span class="title">Closeable</span></div></pre></td></tr></table></figure>
<blockquote>
<p>This class implements <code>client sockets</code> (also called just <code>sockets</code>).</p>
<p>A socket is an endpoint for communication between two machines.</p>
<p>The actual work of the socket is performed by an instance of the <code>SocketImpl</code> class. An application, by changing the socket factory that creates the socket implementation, can configure itself to create sockets appropriate to the local firewall.</p>
</blockquote>
<hr>
<p><a href="https://docs.oracle.com/javase/8/docs/api/java/net/ServerSocket.html" target="_blank" rel="external">ServerSocket</a> class:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ServerSocket</span></span></div><div class="line"><span class="keyword">extends</span> <span class="title">Object</span></div><div class="line"><span class="keyword">implements</span> <span class="title">Closeable</span></div></pre></td></tr></table></figure>
<blockquote>
<p>This class implements <code>server sockets</code>. </p>
<p>A server socket waits for requests to come in over the network. It performs some operation based on that request, and then possibly returns a result to the requester.</p>
<p>The actual work of the server socket is performed by an instance of the <code>SocketImpl</code> class. An application can change the socket factory that creates the socket implementation to configure itself to create sockets appropriate to the local firewall.</p>
</blockquote>
<h2 id="Communication-between-Client-and-Server"><a href="#Communication-between-Client-and-Server" class="headerlink" title="Communication between Client and Server"></a>Communication between Client and Server</h2><h3 id="Process-in-Client-Side"><a href="#Process-in-Client-Side" class="headerlink" title="Process in Client Side"></a>Process in Client Side</h3><ol>
<li>Create TCP client sockets with <code>Socket</code> object. Specify the destination of targeted server when initializing clients</li>
<li><p>If clients are created successfully, it means the data transportation channel is established. The channel is socket stream, which is constructed underlayer. Since it’s a stream, it indicates that there are both input stream and output stream.</p>
<p> You can get those two streams from <code>Socket</code> objects by calling <code>getOutputStream()</code> and <code>getInputStream()</code>.</p>
</li>
<li>Use the stream to transport data</li>
<li>Close resources</li>
</ol>
<p>Example:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// Client End</span></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ClientDemo</span></span>&#123;</div><div class="line">    <span class="comment">/*</span></div><div class="line">        Client sends data to Server</div><div class="line">    */</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String args[])</span> <span class="keyword">throws</span> UnknownHostException, IOException</span>&#123;</div><div class="line">        <span class="comment">// 1. Create client socket</span></div><div class="line">        Socket socket = <span class="keyword">new</span> Socket(<span class="string">"10.128.51.138"</span>, <span class="number">10002</span>);</div><div class="line">         </div><div class="line">        <span class="comment">// 2. Get the output stream from socket</span></div><div class="line">        OutputStream out = socket.getOutputStream();</div><div class="line">         </div><div class="line">        <span class="comment">// 3. Use output stream to write data to Server </span></div><div class="line">        out.write(<span class="string">"TCP demo!"</span>.getBytes());</div><div class="line">         </div><div class="line">        <span class="comment">// 4. Close resources</span></div><div class="line">        socket.close();</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="Process-in-Server-Side"><a href="#Process-in-Server-Side" class="headerlink" title="Process in Server Side"></a>Process in Server Side</h3><ol>
<li>Create server side socket service by creating <code>ServerSocket</code> object</li>
<li><code>ServerSocket</code> must provide a <code>port</code> for client to connect to</li>
<li>Get the socket object that tries to connect</li>
<li>Read data from client via the socket object’s stream</li>
<li>Close resources</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// Server End</span></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ServerDemo</span> </span>&#123;</div><div class="line">    <span class="comment">/**</span></div><div class="line">        Get the data from client, and print on console</div><div class="line">    */</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> UnknownHostException, IOException</span>&#123;</div><div class="line">        <span class="comment">// 1. Create server side socket service by creating `ServerSocket` object</span></div><div class="line">        <span class="comment">// 2. `ServerSocket` must provide a `port` for client to connect to</span></div><div class="line">        ServerSocket ss = <span class="keyword">new</span> ServerSocket(<span class="number">10002</span>);</div><div class="line">         </div><div class="line">        <span class="comment">// 3. Get the socket object that tries to connect</span></div><div class="line">        Socket s = ss.accept();</div><div class="line">        String ip = s.getInetAddress().getHostAddress();</div><div class="line">         </div><div class="line">        <span class="comment">// 4. Read data from client via the socket object's stream</span></div><div class="line">        InputStream in = s.getInputStream();</div><div class="line">        <span class="keyword">byte</span>[] buf = <span class="keyword">new</span> <span class="keyword">byte</span>[<span class="number">1024</span>];</div><div class="line">        <span class="keyword">int</span> len = in.read(buf);</div><div class="line">        </div><div class="line">        String text = <span class="keyword">new</span> String(buf,<span class="number">0</span>,len);</div><div class="line">        System.out.println(ip + <span class="string">" Server: "</span> + text);</div><div class="line">        </div><div class="line">        <span class="number">5</span>. Close resources</div><div class="line">        s.close();</div><div class="line">        ss.close();</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="Interaction-between-Client-and-Server-Sending-Data-back-and-forth"><a href="#Interaction-between-Client-and-Server-Sending-Data-back-and-forth" class="headerlink" title="Interaction between Client and Server - Sending Data back and forth"></a>Interaction between Client and Server - Sending Data back and forth</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// Server Side</span></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ServerDemo2</span> </span>&#123;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> UnknownHostException, IOException</span>&#123;</div><div class="line">        ServerSocket serverSocket = <span class="keyword">new</span> ServerSocket(<span class="number">10002</span>);</div><div class="line">        Socket socket = serverSocket.accept(); <span class="comment">// This is a blocking method</span></div><div class="line">         </div><div class="line">        String ip = socket.getInetAddress().getHostAddress();</div><div class="line">        InputStream in = socket.getInputStream();</div><div class="line">         </div><div class="line">        <span class="keyword">byte</span>[] buf = <span class="keyword">new</span> <span class="keyword">byte</span>[<span class="number">1024</span>];</div><div class="line">        <span class="keyword">int</span> len = in.read(buf);</div><div class="line">        </div><div class="line">        String text = <span class="keyword">new</span> String(buf,<span class="number">0</span>,len);</div><div class="line">        System.out.println(ip + <span class="string">"  "</span> + text);</div><div class="line">         </div><div class="line">        <span class="comment">// Write through ServerSocket's OutputStream to client socket's InputStream </span></div><div class="line">        OutputStream out = socket.getOutputStream();</div><div class="line">        out.write(<span class="string">"Received"</span>.getBytes());</div><div class="line">         </div><div class="line">        socket.close();</div><div class="line">        serverSocket.close();</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// Client Side</span></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ClientDemo2</span></span>&#123;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String args[])</span> <span class="keyword">throws</span> UnknownHostException, IOException</span>&#123;</div><div class="line">        Socket socket = <span class="keyword">new</span> Socket(<span class="string">"10.128.51.138"</span>, <span class="number">10002</span>);</div><div class="line">         </div><div class="line">        OutputStream out = socket.getOutputStream();</div><div class="line">        out.write(<span class="string">"TCP demo!"</span>.getBytes());</div><div class="line">         </div><div class="line">        <span class="comment">// Use socket's InputStream to read data sent from server</span></div><div class="line">        InputStream in = socket.getInputStream();</div><div class="line">        <span class="keyword">byte</span>[] buf = <span class="keyword">new</span> <span class="keyword">byte</span>[<span class="number">1024</span>];</div><div class="line">         </div><div class="line">        <span class="keyword">int</span> len = in.read(buf);</div><div class="line">         </div><div class="line">        String text = <span class="keyword">new</span> String(buf,<span class="number">0</span>,len);</div><div class="line">        System.out.println(text);</div><div class="line">         </div><div class="line">        socket.close();</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="Text-Conversion"><a href="#Text-Conversion" class="headerlink" title="Text Conversion"></a>Text Conversion</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// Server End</span></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TransServer</span></span>&#123;</div><div class="line">    <span class="comment">/*</span></div><div class="line">        Server 转换服务器</div><div class="line">        Analysis:</div><div class="line">        1. Create ServerSocket</div><div class="line">        2. Get Socket obejct</div><div class="line">        3. Get socket's InputStream, and decorate it </div><div class="line">        4. Get socket's OutputStream, decorate it, and write data through it</div><div class="line">        5. Close resources</div><div class="line">    */</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> UnknownHostException, IOException</span>&#123;</div><div class="line">        <span class="comment">// 1. Create ServerSocket</span></div><div class="line">        ServerSocket ss = <span class="keyword">new</span> ServerSocket(<span class="number">10004</span>);</div><div class="line">       </div><div class="line">        <span class="comment">// 2. Get Socket obejct</span></div><div class="line">        Socket s = ss.accept(); <span class="comment">// Blocking!</span></div><div class="line">         </div><div class="line">        <span class="comment">// Get IP</span></div><div class="line">        String ip = s.getInetAddress().getHostAddress();</div><div class="line">        System.out.println(ip+<span class="string">"....connected"</span>);</div><div class="line">         </div><div class="line">        <span class="comment">// 3. Get socket's InputStream, and decorate it </span></div><div class="line">        BufferedReader bIn = <span class="keyword">new</span> BufferedReader(<span class="keyword">new</span> InputStreamReader(s.getInputStream()));</div><div class="line">         </div><div class="line">        <span class="comment">// 4. Get socket's OutputStream, decorate it, and write data through it</span></div><div class="line">        PrintWriter out = <span class="keyword">new</span> PrintWriter(s.getOutputStream(),<span class="keyword">true</span>);</div><div class="line">        </div><div class="line">        String line = <span class="keyword">null</span>;</div><div class="line">        <span class="keyword">while</span>((line=bIn.readLine())!=<span class="keyword">null</span>)&#123;</div><div class="line">            System.out.println(line + <span class="string">"...."</span> + line.toUpperCase());</div><div class="line">            out.println();</div><div class="line">        &#125;</div><div class="line">        </div><div class="line">        <span class="comment">// 5. Close resources</span></div><div class="line">        s.close();</div><div class="line">        ss.close();</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// Client End</span></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TransClient</span> </span>&#123;</div><div class="line">    <span class="comment">/*</span></div><div class="line">        Analysis:</div><div class="line">        </div><div class="line">        Client Side:</div><div class="line">        1. Need a socket endpoint</div><div class="line">        2. data source: keyboard input</div><div class="line">        3. data destination: socket's OutputStream</div><div class="line">        4. data source from server: socket's InputStream</div><div class="line">        4. print data on console</div><div class="line">        6. all data processed is text data</div><div class="line"></div><div class="line">        转换客户端</div><div class="line">        1，创建socket客户端对象</div><div class="line">        2，获取键盘录入</div><div class="line">        3，将录入的信息发给socket输出流</div><div class="line">    */</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span><span class="keyword">throws</span> UnknownHostException, IOException</span>&#123;</div><div class="line">        Socket s = <span class="keyword">new</span> Socket(<span class="string">"10.128.51.138"</span>,<span class="number">10004</span>);</div><div class="line">         </div><div class="line">        <span class="comment">// Get data from keyboard</span></div><div class="line">        BufferedReader br = <span class="keyword">new</span> BufferedReader(<span class="keyword">new</span> InputStreamReader(System.in));</div><div class="line">         </div><div class="line">        <span class="comment">// socket's OutputStream</span></div><div class="line">        PrintWriter out = <span class="keyword">new</span> PrintWriter(s.getOutputStream(), <span class="keyword">true</span>);  <span class="comment">// `true` means supporting continue to write</span></div><div class="line">         </div><div class="line">        <span class="comment">// Read data from server via socket's InputStream</span></div><div class="line">        BufferedReader bIn = <span class="keyword">new</span> BufferedReader(<span class="keyword">new</span> InputStreamReader(s.getInputStream()));</div><div class="line">         </div><div class="line">        String line = <span class="keyword">null</span>;</div><div class="line">        <span class="keyword">while</span>((line=br.readLine())!=<span class="keyword">null</span>)&#123;</div><div class="line">            <span class="keyword">if</span>(<span class="string">"over"</span>.equals(line)) &#123;</div><div class="line">                <span class="keyword">break</span>;</div><div class="line">            &#125;</div><div class="line">         		   </div><div class="line">        	<span class="comment">//out.print(line+"\r\n");</span></div><div class="line">            <span class="comment">//out.flush();</span></div><div class="line">            out.println(line);</div><div class="line">            <span class="comment">// Write data to server, println() is PrintWriter's method, is different from System.out.println()</span></div><div class="line">         </div><div class="line">            <span class="comment">// Read a line of text in upper cases from server</span></div><div class="line">            String upperStr = bIn.readLine();</div><div class="line">            System.out.println(upperStr);</div><div class="line">        &#125;</div><div class="line">        </div><div class="line">        s.close();</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="Practice"><a href="#Practice" class="headerlink" title="Practice"></a>Practice</h2><h3 id="Uploading-Files"><a href="#Uploading-Files" class="headerlink" title="Uploading Files"></a>Uploading Files</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UploadServer</span> </span>&#123;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> UnknownHostException, SocketException,IOException</span>&#123;</div><div class="line">        ServerSocket ss = <span class="keyword">new</span> ServerSocket(<span class="number">10005</span>);</div><div class="line">        Socket s = ss.accept();</div><div class="line">        System.out.println(s.getInetAddress().getHostAddress()+<span class="string">"...connected"</span>);</div><div class="line">         </div><div class="line">        BufferedReader bIn = <span class="keyword">new</span> BufferedReader(<span class="keyword">new</span> InputStreamReader(s.getInputStream())); </div><div class="line">        BufferedWriter bw = <span class="keyword">new</span> BufferedWriter(<span class="keyword">new</span> FileWriter(<span class="string">"Server.txt"</span>));</div><div class="line">         </div><div class="line">        String line = <span class="keyword">null</span>;</div><div class="line">        <span class="keyword">while</span>((line=bIn.readLine())!=<span class="keyword">null</span>)&#123;</div><div class="line">            bw.write(line);</div><div class="line">            bw.newLine();</div><div class="line">            bw.flush();</div><div class="line">        &#125;</div><div class="line">         </div><div class="line">        PrintWriter out = <span class="keyword">new</span> PrintWriter(s.getOutputStream(),<span class="keyword">true</span>);</div><div class="line">        out.println(<span class="string">"Successful!"</span>);</div><div class="line">         </div><div class="line">        bw.close();</div><div class="line">        s.close();</div><div class="line">        ss.close();</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UploadClient</span> </span>&#123;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> UnknownHostException,SocketException, IOException</span>&#123;</div><div class="line">        Socket s = <span class="keyword">new</span> Socket(<span class="string">"183.174.66.227"</span>, <span class="number">10005</span>);</div><div class="line">        </div><div class="line">        BufferedReader br = <span class="keyword">new</span> BufferedReader(<span class="keyword">new</span> FileReader(<span class="string">"client.txt"</span>));</div><div class="line">        PrintWriter out = <span class="keyword">new</span> PrintWriter(s.getOutputStream(),<span class="keyword">true</span>);</div><div class="line">         </div><div class="line">        String line = <span class="keyword">null</span>;</div><div class="line">        <span class="keyword">while</span>((line=br.readLine())!=<span class="keyword">null</span>)&#123;</div><div class="line">            out.println(line);</div><div class="line">        &#125;</div><div class="line"> </div><div class="line">        <span class="comment">// Tell the server side that client has finished writing</span></div><div class="line">        s.shutdownOutput();</div><div class="line">         </div><div class="line">        BufferedReader bIn = <span class="keyword">new</span> BufferedReader(<span class="keyword">new</span> InputStreamReader(s.getInputStream()));</div><div class="line">        String str = bIn.readLine();</div><div class="line">        System.out.println(str);</div><div class="line">         </div><div class="line">        br.close();</div><div class="line">        bIn.close();</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="Uploading-Pictures"><a href="#Uploading-Pictures" class="headerlink" title="Uploading Pictures"></a>Uploading Pictures</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UploadPicServer</span> </span>&#123;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> UnknownHostException,SocketException, IOException</span>&#123;</div><div class="line">        ServerSocket ss = <span class="keyword">new</span> ServerSocket(<span class="number">10006</span>);</div><div class="line">        Socket s = ss.accept();</div><div class="line">         </div><div class="line">        InputStream in = s.getInputStream();</div><div class="line">        String ip = s.getInetAddress().getHostAddress();</div><div class="line">        System.out.println(ip+<span class="string">"....connected"</span>);</div><div class="line">         </div><div class="line">        <span class="comment">// Read data and put it in a file</span></div><div class="line">        File dir = <span class="keyword">new</span> File(<span class="string">"pic"</span>);</div><div class="line">        <span class="keyword">if</span>(!dir.exists()) &#123;</div><div class="line">            dir.mkdirs();</div><div class="line">        &#125;</div><div class="line">         </div><div class="line">        File file = <span class="keyword">new</span> File(dir, ip + <span class="string">".bmp"</span>);</div><div class="line">        FileOutputStream fos = <span class="keyword">new</span> FileOutputStream(file);</div><div class="line">         </div><div class="line">        <span class="keyword">byte</span>[] buf = <span class="keyword">new</span> <span class="keyword">byte</span>[<span class="number">1024</span>];</div><div class="line">        <span class="keyword">int</span> len = <span class="number">0</span>;</div><div class="line">        <span class="keyword">while</span>((len=in.read(buf))!=-<span class="number">1</span>)&#123;</div><div class="line">            fos.write(buf,<span class="number">0</span>,len);</div><div class="line">        &#125;</div><div class="line">         </div><div class="line">        <span class="comment">// Get socket's OutputStream, and send text to client</span></div><div class="line">        OutputStream out = s.getOutputStream();</div><div class="line">        out.write(<span class="string">"Successful!"</span>.getBytes());</div><div class="line">         </div><div class="line">        fos.close();</div><div class="line">        s.close();</div><div class="line">        ss.close();</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UploadPicClient</span> </span>&#123;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> UnknownHostException,SocketException, IOException</span>&#123;</div><div class="line">        Socket s = <span class="keyword">new</span> Socket(<span class="string">"183.174.66.227"</span>, <span class="number">10006</span>);</div><div class="line">        FileInputStream fis = <span class="keyword">new</span> FileInputStream(<span class="string">"0.jpg"</span>);</div><div class="line">        OutputStream out = s.getOutputStream();</div><div class="line">         </div><div class="line">        <span class="keyword">byte</span>[] buf = <span class="keyword">new</span> <span class="keyword">byte</span>[<span class="number">1024</span>];</div><div class="line">        <span class="keyword">int</span> len = <span class="number">0</span>;</div><div class="line">        <span class="keyword">while</span>((len=fis.read(buf))!=-<span class="number">1</span>)&#123;</div><div class="line">            out.write(buf,<span class="number">0</span>,len);</div><div class="line">        &#125;</div><div class="line">         </div><div class="line">        <span class="comment">// Tell Server that it has finished data transportion, and let server stop reading</span></div><div class="line">        s.shutdownOutput();</div><div class="line">         </div><div class="line">        <span class="comment">// Read content from server</span></div><div class="line">        InputStream in = s.getInputStream();</div><div class="line">        <span class="keyword">byte</span>[] bufIn = <span class="keyword">new</span> <span class="keyword">byte</span>[<span class="number">1024</span>];</div><div class="line">         </div><div class="line">        <span class="keyword">int</span> lenIn = in.read(buf);</div><div class="line">        String text = <span class="keyword">new</span> String(buf,<span class="number">0</span>,lenIn);</div><div class="line">        System.out.println(text);</div><div class="line">         </div><div class="line">        fis.close();</div><div class="line">        s.close();</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="Multi-Threaded-Server"><a href="#Multi-Threaded-Server" class="headerlink" title="Multi-Threaded Server"></a>Multi-Threaded Server</h2><p>客户端不变<br>服务端变为</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UploadPicServer</span> </span>&#123;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> UnknownHostException,SocketException, IOException</span>&#123;</div><div class="line">        <span class="comment">//创建TCP的socket服务端</span></div><div class="line">        ServerSocket ss = <span class="keyword">new</span> ServerSocket(<span class="number">10006</span>);</div><div class="line">         </div><div class="line">        <span class="keyword">while</span>(<span class="keyword">true</span>)&#123;</div><div class="line">            Socket s = ss.accept();</div><div class="line">            <span class="keyword">new</span> Thread(<span class="keyword">new</span> UploadTask(s)).start();</div><div class="line">        &#125;</div><div class="line">         </div><div class="line">        ss.close();</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UploadTask</span> <span class="keyword">implements</span> <span class="title">Runnable</span>  </span>&#123;</div><div class="line">   <span class="keyword">private</span> Socket s;</div><div class="line"> </div><div class="line">   <span class="function"><span class="keyword">public</span> <span class="title">UploadTask</span><span class="params">(Socket s)</span></span>&#123;</div><div class="line">      <span class="keyword">this</span>.s = s;</div><div class="line">   &#125;</div><div class="line"> </div><div class="line">   <span class="comment">//@override</span></div><div class="line">   <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span></span>&#123;</div><div class="line">          <span class="keyword">int</span> count = <span class="number">0</span>;</div><div class="line">          String ip = s.getInetAddress().getHostAddress();</div><div class="line">          System.out.println(ip+<span class="string">"....connected"</span>);</div><div class="line">     </div><div class="line">          <span class="keyword">try</span>&#123;</div><div class="line">                 <span class="comment">//读取客户端发来的数据</span></div><div class="line">                 InputStream in = s.getInputStream();</div><div class="line">         </div><div class="line">                 <span class="comment">//将读取到的数据存储到一个文件中</span></div><div class="line">                 File dir = <span class="keyword">new</span> File(<span class="string">"pic"</span>);</div><div class="line">                 <span class="keyword">if</span>(!dir.exists())</div><div class="line">                          dir.mkdirs();</div><div class="line">        </div><div class="line">                 File file = <span class="keyword">new</span> File(dir,ip+<span class="string">".jpg"</span>);</div><div class="line">                 <span class="comment">//如果文件已经存在与服务器端</span></div><div class="line">                 <span class="keyword">if</span>(file.exists())&#123;</div><div class="line">                          file = <span class="keyword">new</span> File(dir,ip+<span class="string">" "</span>+(++count)+<span class="string">".jpg"</span>);</div><div class="line">                 &#125;</div><div class="line">         </div><div class="line">                 FileOutputStream fos = <span class="keyword">new</span> FileOutputStream(file);</div><div class="line">                 <span class="keyword">byte</span>[] buf = <span class="keyword">new</span> <span class="keyword">byte</span>[<span class="number">1024</span>];</div><div class="line">                 <span class="keyword">int</span> len = <span class="number">0</span>;</div><div class="line">                 <span class="keyword">while</span>((len=in.read(buf))!=-<span class="number">1</span>)&#123;</div><div class="line">                          fos.write(buf,<span class="number">0</span>,len);</div><div class="line">                 &#125;</div><div class="line">         </div><div class="line">                 <span class="comment">//获取socket输出流，将上传成功字样发给客户端</span></div><div class="line">                 OutputStream out = s.getOutputStream();</div><div class="line">                 out.write(<span class="string">"上传成功"</span>.getBytes());</div><div class="line">         </div><div class="line">                 fos.close();</div><div class="line">                 s.close();</div><div class="line">         &#125;<span class="keyword">catch</span>(IOException e)&#123;&#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>GET / HTTP/1.1  请求行  请求方式  /myweb/1.html  请求的资源路径   http协议版本。<br>请求消息头 . 属性名：属性值</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">Host: 192.168.1.100:9090</div><div class="line">Connection: Keep-Alive </div><div class="line">Accept: image/gif, image/x-xbitmap, image/jpeg, image/pjpeg, application/x-shockwave-flash, </div><div class="line">application/vnd.ms-excel, application/vnd.ms-powerpoint, application/msword, */*</div><div class="line">Accept: */*     </div><div class="line">Accept-Language: zh-cn,zu;q=0.5</div><div class="line">Accept-Encoding: gzip, deflate</div><div class="line">User-Agent: Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1; InfoPath.2)</div><div class="line">//空行   信息头与信息体之间必须有一个空行，用以分割两部分</div><div class="line">//请求体</div></pre></td></tr></table></figure>
<h2 id="Common-Clients-and-Server-and-Principles-behind-them"><a href="#Common-Clients-and-Server-and-Principles-behind-them" class="headerlink" title="Common Clients and Server, and Principles behind them"></a>Common Clients and Server, and Principles behind them</h2><p>The most common clients - web browser, or custom client<br>The most common server - web servers, like Apache Tomcat, Ngnix, JBoss, WebSphere</p>
<p>In order to learn the principles of server, let’s implement a mocked server and use existing client - web browser - to see what kind of data client sends to server</p>
<h3 id="Mocked-Server"><a href="#Mocked-Server" class="headerlink" title="Mocked Server"></a>Mocked Server</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyTomcatDemo</span>  </span>&#123;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException, UnknownHostException, SocketException</span>&#123;</div><div class="line">        ServerSocket ss = <span class="keyword">new</span> ServerSocket(<span class="number">9090</span>);</div><div class="line">        Socket s = ss.accept();</div><div class="line">        System.out.println(s.getInetAddress().getHostAddress()+<span class="string">"....connected"</span>);</div><div class="line">         </div><div class="line">        InputStream in = s.getInputStream();</div><div class="line">        <span class="keyword">byte</span>[] buf = <span class="keyword">new</span> <span class="keyword">byte</span>[<span class="number">1024</span>];</div><div class="line">        <span class="keyword">int</span> len = in.read(buf);</div><div class="line">        String text = <span class="keyword">new</span> String(buf,<span class="number">0</span>,len);</div><div class="line">        System.out.println(text);</div><div class="line">         </div><div class="line">        <span class="comment">// Send a message to client</span></div><div class="line">        PrintWriter out = <span class="keyword">new</span> PrintWriter(s.getOutputStream(), <span class="keyword">true</span>);</div><div class="line">         </div><div class="line">        out.println(<span class="string">"&lt;font size=7&gt;Welcome&lt;/font&gt;"</span>);</div><div class="line">         </div><div class="line">        s.close();</div><div class="line">        ss.close();</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="Mocked-Client"><a href="#Mocked-Client" class="headerlink" title="Mocked Client"></a>Mocked Client</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyBrowserDemo</span>  </span>&#123;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException, UnknownHostException, SocketException</span>&#123;</div><div class="line">        Socket s = <span class="keyword">new</span> Socket(<span class="string">"183.174.66.227"</span>,<span class="number">8080</span>);</div><div class="line">         </div><div class="line">        <span class="comment">// Mock web browser, send a HTTP request to Tomcat</span></div><div class="line">        PrintWriter out = <span class="keyword">new</span> PrintWriter(s.getOutputStream(),<span class="keyword">true</span>);</div><div class="line">        out.println(<span class="string">"GET /1.html HTTP/1.1"</span>);</div><div class="line">        out.println(<span class="string">"Accept: */*"</span>);</div><div class="line">        out.println(<span class="string">"Host: 183.174.66.227:8080"</span>);</div><div class="line">        out.println(<span class="string">"Connection: close"</span>);</div><div class="line">        out.println();</div><div class="line">        out.println();</div><div class="line">         </div><div class="line">        InputStream in = s.getInputStream();</div><div class="line">        <span class="keyword">byte</span>[] buf = <span class="keyword">new</span> <span class="keyword">byte</span>[<span class="number">1024</span>];</div><div class="line">        <span class="keyword">int</span> len = in.read(buf);</div><div class="line">         </div><div class="line">        String str = <span class="keyword">new</span> String(buf,<span class="number">0</span>,len);</div><div class="line">        System.out.println(str);</div><div class="line">         </div><div class="line">        s.close();</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">// The message received is:</div><div class="line">HTTP/1.1 200 OK     // response line, with HTTP version number, status code, and status message</div><div class="line">// Response&apos;s attribtues-  &lt;name&gt;: &lt;value&gt;</div><div class="line">Server: Apache-Coyote/1.1</div><div class="line">Accept-Ranges: bytes</div><div class="line">ETag: W/&quot;43-1357224984849&quot;</div><div class="line">Last-Modified: Thu, 03 Jan 2013 14:56:24 GMT</div><div class="line">Content-Type: text/html</div><div class="line">Content-Length: 43</div><div class="line">Date: Thu, 03 Jan 2013 16:12:54 GMT</div><div class="line">Connection: close</div><div class="line">// Empty line</div><div class="line">// Response body</div><div class="line">&lt;font color = &quot;blue&quot; size=7&gt;welcome&lt;/font&gt;</div></pre></td></tr></table></figure>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/06/07/spring/Spring-Conditional-Annotation-and-Condition-Interface-in-Action/" itemprop="url">
                  Spring - @Conditional Annotation and Condition Interface in Action
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">Posted on</span>
            <time itemprop="dateCreated" datetime="2016-06-07T16:03:09+08:00" content="2016-06-07">
              2016-06-07
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">In</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/spring/" itemprop="url" rel="index">
                    <span itemprop="name">spring</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2016/06/07/spring/Spring-Conditional-Annotation-and-Condition-Interface-in-Action/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2016/06/07/spring/Spring-Conditional-Annotation-and-Condition-Interface-in-Action/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          <h2 id="Spring-Conditional-Annotation"><a href="#Spring-Conditional-Annotation" class="headerlink" title="Spring @Conditional Annotation"></a>Spring @Conditional Annotation</h2><p>From <a href="http://docs.spring.io/spring/docs/current/javadoc-api/org/springframework/context/annotation/Conditional.html">Spring API Doc</a></p>
<blockquote>
<p>Indicates that a component is only eligible for registration when all specified conditions match.</p>
<p>A condition is any state that can be determined programmatically before the bean definition is due to be registered (see Condition for details).</p>
<p>The <code>@Conditional</code> annotation may be used in any of the following ways:</p>
<ul>
<li>as a type-level annotation on any class directly or indirectly annotated with <code>@Component</code>, including <code>@Configuration</code> classes</li>
<li>as a meta-annotation, for the purpose of composing custom stereotype annotations</li>
<li>as a method-level annotation on any <code>@Bean</code> method</li>
</ul>
<p>If a <code>@Configuration</code> class is marked with <code>@Conditional</code>, all of the <code>@Bean</code> methods, <code>@Import</code> annotations, and <code>@ComponentScan</code> annotations associated with that class will be subject to the conditions.</p>
</blockquote>
          <div class="post-more-link text-center">
            <a class="btn" href="/2016/06/07/spring/Spring-Conditional-Annotation-and-Condition-Interface-in-Action/#more" rel="contents">
              Read more &raquo;
            </a>
          </div>
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/06/05/web development/rest/RESTful-What-is-Idempotent/" itemprop="url">
                  RESTful - What is Idempotent
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">Posted on</span>
            <time itemprop="dateCreated" datetime="2016-06-05T23:31:22+08:00" content="2016-06-05">
              2016-06-05
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">In</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/web-development/" itemprop="url" rel="index">
                    <span itemprop="name">web development</span>
                  </a>
                </span>

                
                
                  , 
                

              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/web-development/rest/" itemprop="url" rel="index">
                    <span itemprop="name">rest</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2016/06/05/web development/rest/RESTful-What-is-Idempotent/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2016/06/05/web development/rest/RESTful-What-is-Idempotent/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          <h1 id="Idempotence"><a href="#Idempotence" class="headerlink" title="Idempotence"></a>Idempotence</h1><p>Reference:  <a href="http://www.restapitutorial.com/lessons/idempotency.html">http://www.restapitutorial.com/lessons/idempotency.html</a></p>
<p><code>Idempotence</code> is a funky word that often hooks people. Idempotence is sometimes a confusing concept, at least from the academic definition.</p>
<blockquote>
<p>From a <code>RESTful</code> service standpoint, for an operation (or service call) to be <code>idempotent</code>, clients can make that same call repeatedly while producing the same result. </p>
<p>In other words, making multiple identical requests has the same effect as making a single request. <code>Note that while idempotent operations produce the same result on the server (no side effects), the response itself may not be the same</code> (e.g. a resource’s state may change between requests).</p>
</blockquote>
          <div class="post-more-link text-center">
            <a class="btn" href="/2016/06/05/web development/rest/RESTful-What-is-Idempotent/#more" rel="contents">
              Read more &raquo;
            </a>
          </div>
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/05/22/web development/rest/What-is-REST-RESTful/" itemprop="url">
                  What is REST/RESTful
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">Posted on</span>
            <time itemprop="dateCreated" datetime="2016-05-22T22:14:08+08:00" content="2016-05-22">
              2016-05-22
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">In</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/web-development/" itemprop="url" rel="index">
                    <span itemprop="name">web development</span>
                  </a>
                </span>

                
                
                  , 
                

              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/web-development/rest/" itemprop="url" rel="index">
                    <span itemprop="name">rest</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2016/05/22/web development/rest/What-is-REST-RESTful/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2016/05/22/web development/rest/What-is-REST-RESTful/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          <p>Found <a href="https://spring.io/understanding/REST">this article</a> explaining <code>what is rest</code> quite well. It can be a great introduction for newbies to understand REST.</p>
<hr>
<h1 id="Understanding-REST"><a href="#Understanding-REST" class="headerlink" title="Understanding REST"></a>Understanding REST</h1><p><code>REST (Representational State Transfer)</code> was introduced and defined in 2000 by Roy Fielding in his doctoral dissertation. REST is an architectural style for designing distributed systems. It is not a standard but a set of constraints, such as being stateless, having a client/server relationship, and a uniform interface. REST is not strictly related to HTTP, but it is most commonly associated with it.</p>
<h1 id="Principles-of-REST"><a href="#Principles-of-REST" class="headerlink" title="Principles of REST"></a>Principles of REST</h1><ul>
<li><code>Resources</code> - expose easily understood directory structure URIs.</li>
<li><code>Representations</code> - transfer JSON or XML to represent data objects and attributes.</li>
<li><code>Messages</code> - use HTTP methods explicitly (for example, <code>GET</code>, <code>POST</code>, <code>PUT</code>, and <code>DELETE</code>).</li>
<li><code>Stateless</code> - interactions store no client context on the server between requests. State dependencies limit and restrict scalability. The client holds session state.</li>
</ul>
          <div class="post-more-link text-center">
            <a class="btn" href="/2016/05/22/web development/rest/What-is-REST-RESTful/#more" rel="contents">
              Read more &raquo;
            </a>
          </div>
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/05/20/system design/messaging/System-Design-When-to-use-Push-and-Pull-mechanism-in-a-messaging-app-or-the-timeline-of-a-social-app/" itemprop="url">
                  System Design - When to use Push and Pull mechanism in a messaging app or the timeline of a social app
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">Posted on</span>
            <time itemprop="dateCreated" datetime="2016-05-20T17:57:53+08:00" content="2016-05-20">
              2016-05-20
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">In</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/system-design/" itemprop="url" rel="index">
                    <span itemprop="name">system design</span>
                  </a>
                </span>

                
                
                  , 
                

              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/system-design/messaging/" itemprop="url" rel="index">
                    <span itemprop="name">messaging</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2016/05/20/system design/messaging/System-Design-When-to-use-Push-and-Pull-mechanism-in-a-messaging-app-or-the-timeline-of-a-social-app/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2016/05/20/system design/messaging/System-Design-When-to-use-Push-and-Pull-mechanism-in-a-messaging-app-or-the-timeline-of-a-social-app/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          <h1 id="What-is-Pull-and-Push"><a href="#What-is-Pull-and-Push" class="headerlink" title="What is Pull and Push?"></a>What is Pull and Push?</h1><ul>
<li>Data-pull: build a user’s timeline by pulling data from his followings</li>
<li>Data-push: build a user’s timeline by pushing data from his followings</li>
</ul>
<hr>
<ul>
<li>Link-pull: a user pulls the notification from the server every k seconds</li>
<li>Link-push: the server pushes the notification to the user with WebSocket as soon as it appears</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">         ---------</div><div class="line">         | Users |</div><div class="line">         ---------</div><div class="line">          |    /\    </div><div class="line">link pull |     | link push</div><div class="line">          \/    |</div><div class="line">     -----------------</div><div class="line">     |    Service    |</div><div class="line">     -----------------</div></pre></td></tr></table></figure>
          <div class="post-more-link text-center">
            <a class="btn" href="/2016/05/20/system design/messaging/System-Design-When-to-use-Push-and-Pull-mechanism-in-a-messaging-app-or-the-timeline-of-a-social-app/#more" rel="contents">
              Read more &raquo;
            </a>
          </div>
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/05/18/web development/webhook/What-is-Callback-and-Webhook/" itemprop="url">
                  What is Callback and Webhook
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">Posted on</span>
            <time itemprop="dateCreated" datetime="2016-05-18T23:05:32+08:00" content="2016-05-18">
              2016-05-18
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">In</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/web-development/" itemprop="url" rel="index">
                    <span itemprop="name">web development</span>
                  </a>
                </span>

                
                
                  , 
                

              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/web-development/webhook/" itemprop="url" rel="index">
                    <span itemprop="name">webhook</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2016/05/18/web development/webhook/What-is-Callback-and-Webhook/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2016/05/18/web development/webhook/What-is-Callback-and-Webhook/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          <p>I first know these two words when developing a chatbot on Facebook Messenger. Facebook developer guide has some references and explaination on its webhook, shown here <a href="https://developers.facebook.com/docs/messenger-platform/webhook-reference">https://developers.facebook.com/docs/messenger-platform/webhook-reference</a>. But I didn’t actually get what a webhook realy is, until I saw this <a href="https://medium.com/robinhood-engineering/thorn-easy-webhooks-for-python-82a78e170bdb#.2ut4we18n">blog post talking about Python Thorn developed by Robinhood</a>. So I did some research, and now I’ll well explain to you what a callback and a webhook is.</p>
<h1 id="What-is-a-Callback"><a href="#What-is-a-Callback" class="headerlink" title="What is a Callback"></a>What is a Callback</h1><p>Here’s <a href="http://stackoverflow.com/a/9652434/1936713">a very good answer on stackoverflowing explaining what a callback is</a></p>
<blockquote>
<p>I am going to try to keep this dead simple. A “callback” is any function that is called by another function which takes the first function as a parameter.A lot of the time, a “callback” is a function that is called when something happens. That something can be called an “event” in programmer-speak.`</p>
</blockquote>
<p>Imagine this scenario: You are expecting a package in a couple of days. The package is a gift for your neighbor. Therefore, once you get the package, you want it brought over to the neighbors. You are out of town, and so you leave instructions for your spouse.</p>
<p>You could tell them to get the package and bring it to the neighbors. If your spouse was as stupid as a computer, they would sit at the door and wait for the package until it came (NOT DOING ANYTHING ELSE) and then once it came they would bring it over to the neighbors. But there’s a better way. Tell your spouse that ONCE they receive the package, they should bring it over the neighbors. Then, they can go about life normally UNTIL she receives the package.</p>
<p>In our example, the receiving of the package is the “event” and the bringing it to the neighbors is the “callback”. Your spouse “runs” your instructions to bring the package over only when the package arrives. Much better!</p>
<p>This kind of thinking is obvious in daily life, but computers don’t have the same kind of common sense. Consider how programmers normally write to a file:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">fileObject = open(file)</div><div class="line"># now that we have WAITED for the file to open, we can write to it</div><div class="line">fileObject.write(&quot;We are writing to the file.&quot;)</div><div class="line"># now we can continue doing the other, totally unrelated things our program does</div></pre></td></tr></table></figure>
<p>Here, we WAIT for the file to open, before we write to it. This “blocks” the flow of execution, and our program cannot do any of the other things it might need to do! What if we could do this instead:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"># we pass writeToFile (A CALLBACK FUNCTION!) to the open function</div><div class="line">fileObject = open(file, writeToFile)</div><div class="line"># execution continues flowing -- we don&apos;t wait for the file to be opened</div><div class="line"># ONCE the file is opened we write to it, but while we wait WE CAN DO OTHER THINGS!</div></pre></td></tr></table></figure>
<p>It turns out we do this with some languages and frameworks. It’s pretty cool! Check out Node.js to get some real practice with this kind of thinking.</p>
          <div class="post-more-link text-center">
            <a class="btn" href="/2016/05/18/web development/webhook/What-is-Callback-and-Webhook/#more" rel="contents">
              Read more &raquo;
            </a>
          </div>
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/05/17/database/hibernate/Hibernate-the-hi-lo-algorithm/" itemprop="url">
                  Hibernate - the hi/lo algorithm
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">Posted on</span>
            <time itemprop="dateCreated" datetime="2016-05-17T23:10:04+08:00" content="2016-05-17">
              2016-05-17
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">In</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/database/" itemprop="url" rel="index">
                    <span itemprop="name">database</span>
                  </a>
                </span>

                
                
                  , 
                

              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/database/hibernate/" itemprop="url" rel="index">
                    <span itemprop="name">hibernate</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2016/05/17/database/hibernate/Hibernate-the-hi-lo-algorithm/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2016/05/17/database/hibernate/Hibernate-the-hi-lo-algorithm/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          <p>When designing the database model, you need to be aware of the <code>database identifier strategies</code>. Database sequences are very convenient, because they are both flexible and efficient for most use cases.</p>
<blockquote>
<p>But even with cached sequences, the application requires a database round-trip for every new the sequence value. If your applications demands a high number of insert operations per transaction, the sequence allocation may be optimized with a <code>hi/lo algorithm</code>.</p>
</blockquote>
<h1 id="The-hi-lo-algorithm"><a href="#The-hi-lo-algorithm" class="headerlink" title="The hi/lo algorithm"></a>The hi/lo algorithm</h1><blockquote>
<p>The <code>hi/lo algorithm</code> splits the sequences domain into <code>hi</code> groups. A <code>hi</code> value is assigned <code>synchronously</code>. Every <code>hi</code> group is given a maximum number of <code>lo</code> entries, that can by assigned <code>off-line</code> without worrying about concurrent duplicate entries.</p>
</blockquote>
<p>The <code>hi</code> token is assigned by the database, and two concurrent calls are guaranteed to see unique consecutive values</p>
<p>Once a <code>hi</code> token is retrieved we only need the <code>incrementSize</code> (the number of “lo” entries)</p>
<p>The identifiers range is given by the following formula:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">// [inclusive, exclusive)</div><div class="line">[(hi -1) * incrementSize) + 1, (hi * incrementSize) + 1)</div></pre></td></tr></table></figure>
<p>and the <code>lo</code> value will be taken from:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">[0, incrementSize)</div></pre></td></tr></table></figure>
<p>starting from</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">(hi -1) * incrementSize) + 1</div></pre></td></tr></table></figure>
<p>When all <code>lo</code> values are used, a new <code>hi</code> value is fetched and the cycle continues.</p>
<p>Here you can have an example of two concurrent transactions, each one inserting multiple entities.</p>
          <div class="post-more-link text-center">
            <a class="btn" href="/2016/05/17/database/hibernate/Hibernate-the-hi-lo-algorithm/#more" rel="contents">
              Read more &raquo;
            </a>
          </div>
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/05/15/web development/json/jackson/Jackson-How-does-Jackson-deserialize-json-to-complex-objects/" itemprop="url">
                  Jackson - How does Jackson deserialize json to complex objects?
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">Posted on</span>
            <time itemprop="dateCreated" datetime="2016-05-15T18:02:43+08:00" content="2016-05-15">
              2016-05-15
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">In</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/web-development/" itemprop="url" rel="index">
                    <span itemprop="name">web development</span>
                  </a>
                </span>

                
                
                  , 
                

              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/web-development/json/" itemprop="url" rel="index">
                    <span itemprop="name">json</span>
                  </a>
                </span>

                
                
                  , 
                

              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/web-development/json/jackson/" itemprop="url" rel="index">
                    <span itemprop="name">jackson</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2016/05/15/web development/json/jackson/Jackson-How-does-Jackson-deserialize-json-to-complex-objects/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2016/05/15/web development/json/jackson/Jackson-How-does-Jackson-deserialize-json-to-complex-objects/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          <p>Deserialization is really useful when you are reading a POST entity from a request body and a response body.</p>
<p>Spring boot has packaged Jackson and are using Jackson for objects serialization and deserialization. You can choose another json library if you are using Apache httpclient.</p>
<p>Here’s a demo class that sends a http GET request and receives a response whose entity needs to be deserialized.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">FeedProcessor</span> </span>&#123;</div><div class="line">	 <span class="comment">// Jackson's ObjectMapper</span></div><div class="line">    <span class="keyword">private</span> ObjectMapper mapper = <span class="keyword">new</span> ObjectMapper();</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">retrieveFeed</span><span class="params">()</span> <span class="keyword">throws</span> IOException </span>&#123;</div><div class="line">        HttpClient client = HttpClientBuilder.create().build();</div><div class="line"></div><div class="line">        URI uri = UriComponentsBuilder</div><div class="line">                .fromHttpUrl(FEED_URI)</div><div class="line">                .build()</div><div class="line">                .toUri();</div><div class="line"></div><div class="line">			<span class="comment">// Send http GET request</span></div><div class="line">        HttpGet get = <span class="keyword">new</span> HttpGet(uri);</div><div class="line">        HttpResponse response = client.execute(get);</div><div class="line"></div><div class="line">			<span class="comment">// Deserialize the response's json entity body</span></div><div class="line">        Feed feed = mapper.readValue(response.getEntity().getContent(), Feed.class);</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>The following json is in the entity’s body.</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">	<span class="attr">"nodes"</span>: [</div><div class="line">	&#123;</div><div class="line">		<span class="attr">"node"</span>: &#123;</div><div class="line">			<span class="attr">"title"</span>: <span class="string">"title1"</span>,</div><div class="line">			<span class="attr">"date"</span>: <span class="string">"2016-05-01T09:45:00-07:00"</span>,</div><div class="line">			<span class="attr">"path"</span>: <span class="string">"some url"</span>,</div><div class="line">			<span class="attr">"image"</span>: &#123;</div><div class="line">				<span class="attr">"src"</span>: <span class="string">"some_url/media/ddvotd_1.png"</span></div><div class="line">			&#125;</div><div class="line">		&#125;</div><div class="line">	&#125;, &#123;</div><div class="line">		<span class="attr">"node"</span>: &#123;</div><div class="line">			<span class="attr">"title"</span>: <span class="string">"title2"</span>,</div><div class="line">			<span class="attr">"date"</span>: <span class="string">"2016-05-02T09:45:00-07:00"</span>,</div><div class="line">			<span class="attr">"path"</span>: <span class="string">"some url"</span>,</div><div class="line">			<span class="attr">"image"</span>: &#123;</div><div class="line">				<span class="attr">"src"</span>: <span class="string">"some_url/media/ddvotd_2.png"</span></div><div class="line">			&#125;</div><div class="line">		&#125;</div><div class="line">	&#125;]            </div><div class="line">&#125;</div></pre></td></tr></table></figure>
          <div class="post-more-link text-center">
            <a class="btn" href="/2016/05/15/web development/json/jackson/Jackson-How-does-Jackson-deserialize-json-to-complex-objects/#more" rel="contents">
              Read more &raquo;
            </a>
          </div>
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/05/10/spring/Spring-Set-up-and-Enable-Scheduled-Tasks/" itemprop="url">
                  Spring - Set up and Enable Scheduled Tasks
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">Posted on</span>
            <time itemprop="dateCreated" datetime="2016-05-10T11:25:40+08:00" content="2016-05-10">
              2016-05-10
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">In</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/spring/" itemprop="url" rel="index">
                    <span itemprop="name">spring</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2016/05/10/spring/Spring-Set-up-and-Enable-Scheduled-Tasks/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2016/05/10/spring/Spring-Set-up-and-Enable-Scheduled-Tasks/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          <h1 id="Annotation-EnableScheduling-and-Scheduled"><a href="#Annotation-EnableScheduling-and-Scheduled" class="headerlink" title="Annotation @EnableScheduling and @Scheduled"></a>Annotation @EnableScheduling and @Scheduled</h1><ul>
<li><a href="http://docs.spring.io/spring/docs/current/javadoc-api/org/springframework/scheduling/annotation/EnableScheduling.html">EnableScheduling.java</a></li>
<li><a href="http://docs.spring.io/spring/docs/current/javadoc-api/org/springframework/scheduling/annotation/Scheduled.html">Scheduled.java</a></li>
</ul>
<p>Annotation <code>@EnableScheduling</code> enables Spring’s scheduled task execution capability, similar to functionality found in Spring’s <code>&lt;task:*&gt;</code> XML namespace. </p>
<p>This enables detection of <code>@Scheduled</code> annotations on any Spring-managed bean in the container. For example, given a class MyTask, the following configuration would ensure that <code>MyTask.work()</code> is called once every 1000 <code>ms</code>:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyTask</span> </span>&#123;</div><div class="line">    <span class="meta">@Scheduled</span>(fixedRate=<span class="number">1000</span>)</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">work</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="comment">// task execution logic</span></div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="meta">@Configuration</span></div><div class="line"><span class="meta">@EnableScheduling</span></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AppConfig</span> </span>&#123;</div><div class="line">    <span class="meta">@Bean</span></div><div class="line">    <span class="function"><span class="keyword">public</span> MyTask <span class="title">task</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> <span class="keyword">new</span> MyTask();</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id=""><a href="#" class="headerlink" title=""></a>
          <div class="post-more-link text-center">
            <a class="btn" href="/2016/05/10/spring/Spring-Set-up-and-Enable-Scheduled-Tasks/#more" rel="contents">
              Read more &raquo;
            </a>
          </div>
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/05/02/spring/Spring-Primary-annotation/" itemprop="url">
                  Spring - @Primary annotation
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">Posted on</span>
            <time itemprop="dateCreated" datetime="2016-05-02T21:19:54+08:00" content="2016-05-02">
              2016-05-02
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">In</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/spring/" itemprop="url" rel="index">
                    <span itemprop="name">spring</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2016/05/02/spring/Spring-Primary-annotation/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2016/05/02/spring/Spring-Primary-annotation/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          <p><code>@Primary</code> indicates that a bean should be given preference when multiple candidates are qualified to autowire a single-valued dependency. If exactly one <code>primary</code> bean exists among the candidates, it will be the autowired value. This annotation is semantically equivalent to the <code>&lt;bean&gt;</code> element’s primary attribute in Spring XML.</p>
<p>May be used on any class directly or indirectly annotated with <code>@Component</code> or on methods annotated with <code>@Bean</code>.</p>
          <div class="post-more-link text-center">
            <a class="btn" href="/2016/05/02/spring/Spring-Primary-annotation/#more" rel="contents">
              Read more &raquo;
            </a>
          </div>
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/04/28/database/hibernate/Hibernate-Hibernate-Enum-and-Decoupling-Java-Class-with-Database-Record/" itemprop="url">
                  Hibernate - Hibernate Enum and Decoupling Java Class with Database Record
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">Posted on</span>
            <time itemprop="dateCreated" datetime="2016-04-28T15:34:59+08:00" content="2016-04-28">
              2016-04-28
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">In</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/database/" itemprop="url" rel="index">
                    <span itemprop="name">database</span>
                  </a>
                </span>

                
                
                  , 
                

              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/database/hibernate/" itemprop="url" rel="index">
                    <span itemprop="name">hibernate</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2016/04/28/database/hibernate/Hibernate-Hibernate-Enum-and-Decoupling-Java-Class-with-Database-Record/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2016/04/28/database/hibernate/Hibernate-Hibernate-Enum-and-Decoupling-Java-Class-with-Database-Record/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="Example-that-Hibernate-Persists-Enum"><a href="#Example-that-Hibernate-Persists-Enum" class="headerlink" title="Example that Hibernate Persists Enum"></a>Example that Hibernate Persists Enum</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div></pre></td><td class="code"><pre><div class="line"><span class="meta">@Table</span>(name = <span class="string">"tasks"</span>)</div><div class="line"><span class="meta">@Entity</span></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Tasks</span> </span>&#123;</div><div class="line">    <span class="keyword">public</span> <span class="keyword">enum</span> Task &#123;</div><div class="line">        Task1                  (<span class="string">"task 1"</span>, Type.Job1),</div><div class="line">        Task2                  (<span class="string">"task 2"</span>, Type.Job2),</div><div class="line">        </div><div class="line">        <span class="keyword">private</span> String name;</div><div class="line">        <span class="keyword">private</span> Type Type;</div><div class="line"></div><div class="line">        <span class="function"><span class="keyword">private</span> <span class="title">Task</span><span class="params">(String n, Type j)</span> </span>&#123;</div><div class="line">            name = n;</div><div class="line">            Type = j;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span>｛</span></div><div class="line">            return name;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="function"><span class="keyword">public</span> Type <span class="title">getType</span><span class="params">()</span> </span>&#123;</div><div class="line">            <span class="keyword">return</span> Type;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="comment">// A map that maps enum name with Task</span></div><div class="line">        <span class="keyword">private</span> <span class="keyword">static</span> Map&lt;String, Task&gt; s_typeMap = <span class="keyword">new</span> HashMap&lt;&gt;();</div><div class="line">        <span class="keyword">static</span> &#123;</div><div class="line">            <span class="keyword">for</span> (Task tt : Task.values()) &#123;</div><div class="line">                s_typeMap.put(tt.name(), tt);</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="comment">/**</span></div><div class="line">         * Converts a String to a enum instance of Task.</div><div class="line">         * Throw an exception if the String does not match any enum's name</div><div class="line">         * */</div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Task <span class="title">fromString</span><span class="params">(String TaskName)</span> </span>&#123;</div><div class="line">            <span class="keyword">if</span>(!s_typeMap.containsKey(TaskName)) &#123;</div><div class="line">                <span class="keyword">throw</span> <span class="keyword">new</span> IllegalArgumentException(<span class="string">"No task type named"</span> + TaskName));</div><div class="line">            &#125;</div><div class="line"></div><div class="line">            <span class="keyword">return</span> s_typeMap.get(TaskName);</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    ...</div><div class="line">    <span class="keyword">private</span> Task m_Task;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Tasks</span><span class="params">()</span> </span>&#123;&#125;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Tasks</span><span class="params">(Task type)</span> </span>&#123;</div><div class="line">        m_Task = type;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Column</span>(name = <span class="string">"type"</span>)</div><div class="line">    <span class="meta">@Enumerated</span>(EnumType.String)</div><div class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getType</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> m_type;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">setType</span><span class="params">(String type)</span> </span>&#123;</div><div class="line">        <span class="keyword">this</span>.m_type= type;</div><div class="line">    &#125;</div><div class="line">    ...</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="Example-that-decouples-enum-and-db-values"><a href="#Example-that-decouples-enum-and-db-values" class="headerlink" title="Example that decouples enum and db values"></a>Example that decouples enum and db values</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div></pre></td><td class="code"><pre><div class="line"><span class="meta">@Table</span>(name = <span class="string">"tasks"</span>)</div><div class="line"><span class="meta">@Entity</span></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Task</span> </span>&#123;</div><div class="line">    <span class="keyword">public</span> <span class="keyword">enum</span> Task &#123;</div><div class="line">        Task1                  (<span class="string">"task 1"</span>, Type.Job1),</div><div class="line">        Task2                  (<span class="string">"task 2"</span>, Type.Job2),</div><div class="line">        </div><div class="line">        <span class="keyword">private</span> String name;</div><div class="line">        <span class="keyword">private</span> Type Type;</div><div class="line"></div><div class="line">        <span class="function"><span class="keyword">private</span> <span class="title">Task</span><span class="params">(String n, Type j)</span> </span>&#123;</div><div class="line">            name = n;</div><div class="line">            Type = j;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span>｛</span></div><div class="line">            return name;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="function"><span class="keyword">public</span> Type <span class="title">getType</span><span class="params">()</span> </span>&#123;</div><div class="line">            <span class="keyword">return</span> Type;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="comment">// A map that maps enum name with Task</span></div><div class="line">        <span class="keyword">private</span> <span class="keyword">static</span> Map&lt;String, Task&gt; s_typeMap = <span class="keyword">new</span> HashMap&lt;&gt;();</div><div class="line">        <span class="keyword">static</span> &#123;</div><div class="line">            <span class="keyword">for</span> (Task tt : Task.values()) &#123;</div><div class="line">                s_typeMap.put(tt.name(), tt);</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="comment">/**</span></div><div class="line">         * Converts a String to a enum instance of Task.</div><div class="line">         * Throw an exception if the String does not match any enum's name</div><div class="line">         * */</div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Task <span class="title">fromString</span><span class="params">(String TaskName)</span> </span>&#123;</div><div class="line">            <span class="keyword">if</span>(!s_typeMap.containsKey(TaskName)) &#123;</div><div class="line">                <span class="keyword">throw</span> <span class="keyword">new</span> IllegalArgumentException(<span class="string">"No task type named"</span> + TaskName));</div><div class="line">            &#125;</div><div class="line"></div><div class="line">            <span class="keyword">return</span> s_typeMap.get(TaskName);</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    ...</div><div class="line">    <span class="keyword">private</span> Task m_Task;</div><div class="line">    <span class="keyword">private</span> String m_typeName;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Tasks</span><span class="params">()</span> </span>&#123;&#125;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Tasks</span><span class="params">(Task type)</span> </span>&#123;</div><div class="line">        m_Task = type;</div><div class="line">        m_typeName = type.name();</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="meta">@Transient</span></div><div class="line">    <span class="function"><span class="keyword">public</span> Task <span class="title">getType</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> Task.fromString(getTypeName());</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setType</span><span class="params">(Task type)</span> </span>&#123;</div><div class="line">        <span class="keyword">this</span>.m_Task = type;</div><div class="line">        setTypeName(m_Task.name());</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Column</span>(name = <span class="string">"type"</span>)</div><div class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getTypeName</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> m_typeName;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line">     * <span class="doctag">@param</span> typeName the name of the Task</div><div class="line">     */</div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">setTypeName</span><span class="params">(String typeName)</span> </span>&#123;</div><div class="line">        <span class="keyword">this</span>.m_typeName = typeName;</div><div class="line">    &#125;</div><div class="line">    ...</div><div class="line">&#125;</div></pre></td></tr></table></figure>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/04/25/database/The-N-1-Query-Problem/" itemprop="url">
                  The N + 1 Query Problem
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">Posted on</span>
            <time itemprop="dateCreated" datetime="2016-04-25T22:49:59+08:00" content="2016-04-25">
              2016-04-25
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">In</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/database/" itemprop="url" rel="index">
                    <span itemprop="name">database</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2016/04/25/database/The-N-1-Query-Problem/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2016/04/25/database/The-N-1-Query-Problem/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          <p><a href="https://secure.phabricator.com/book/phabcontrib/article/n_plus_one/">https://secure.phabricator.com/book/phabcontrib/article/n_plus_one/</a></p>
<h1 id="What-is-N-1-Query-Problem"><a href="#What-is-N-1-Query-Problem" class="headerlink" title="What is N+1 Query Problem"></a>What is N+1 Query Problem</h1><p>The N+1 query problem is a common performance anti-pattern. It looks like this:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">Set&lt;division&gt; divisions = getAllDivisions();</div><div class="line">divisions.foreach (</div><div class="line">    d -&gt; &#123;</div><div class="line">        Set&lt;Employee&gt; employees = getEmployeesByDivision(d)Ï</div><div class="line">        <span class="comment">// ...</span></div><div class="line">    &#125;</div><div class="line">);</div></pre></td></tr></table></figure>
<p>Assuming getAllDivisions() has an implementation that boils down to:</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> divisions;</div></pre></td></tr></table></figure>
<p>and <code>getEmployeesByDivision(d)</code> has an implementation something like this:</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> employees <span class="keyword">WHERE</span> divisionId = d.id;</div></pre></td></tr></table></figure>
<p>You will issue “N+1” queries when the code executes, where N is the number of divisions:</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> divisions;</div><div class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> employees <span class="keyword">WHERE</span> divisionID = <span class="number">1</span></div><div class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> employees <span class="keyword">WHERE</span> divisionID = <span class="number">2</span></div><div class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> employees <span class="keyword">WHERE</span> divisionID = <span class="number">3</span></div><div class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> employees <span class="keyword">WHERE</span> divisionID = <span class="number">4</span></div><div class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> employees <span class="keyword">WHERE</span> divisionID = <span class="number">5</span></div><div class="line">...</div></pre></td></tr></table></figure>
          <div class="post-more-link text-center">
            <a class="btn" href="/2016/04/25/database/The-N-1-Query-Problem/#more" rel="contents">
              Read more &raquo;
            </a>
          </div>
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/04/25/test/jmockit/Unit-Test-JMockit-Difference-between-Expectations-NonStrictExpectations-and-StrictExpectations/" itemprop="url">
                  Unit Test - JMockit - Difference between Expectations, NonStrictExpectations, and StrictExpectations
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">Posted on</span>
            <time itemprop="dateCreated" datetime="2016-04-25T16:22:09+08:00" content="2016-04-25">
              2016-04-25
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">In</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/test/" itemprop="url" rel="index">
                    <span itemprop="name">test</span>
                  </a>
                </span>

                
                
                  , 
                

              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/test/jmockit/" itemprop="url" rel="index">
                    <span itemprop="name">jmockit</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2016/04/25/test/jmockit/Unit-Test-JMockit-Difference-between-Expectations-NonStrictExpectations-and-StrictExpectations/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2016/04/25/test/jmockit/Unit-Test-JMockit-Difference-between-Expectations-NonStrictExpectations-and-StrictExpectations/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          <h2 id="NonStrictExpectations-is-deprecated-now"><a href="#NonStrictExpectations-is-deprecated-now" class="headerlink" title="NonStrictExpectations is deprecated now!"></a>NonStrictExpectations is deprecated now!</h2><p>Before V1.23, <code>Expectations</code> equals <code>StrictExpectations</code>. From V1.23, JMockit has dropped <code>NonStrictExpectations</code>, and replace it with <code>Expectations</code>.</p>
<p>Here’s the release note from JMockit</p>
<blockquote>
<p>Version 1.23 (Apr 24, 2016):</p>
<ul>
<li>Dropped support for the mocking of private methods/constructors when using the <code>Expectations</code> API, to prevent misuse. If still needed, they can be mocked or stubbed out with the application of a <code>MockUp&lt;T&gt;</code>.</li>
<li>Deprecated the <code>NonStrictExpectations</code> class. Existing tests should use <code>Expectations</code> instead.</li>
<li>Added support for JDK 9 (tested with builds 112 to 114).</li>
</ul>
</blockquote>
<h2 id="Regular-versus-strict-expectations"><a href="#Regular-versus-strict-expectations" class="headerlink" title="Regular versus strict expectations"></a>Regular versus strict expectations</h2><p>Expectations recorded inside a <code>new Expectations() {...}</code> block are the regular ones. What this means is that:</p>
<ul>
<li>the invocations they specify are expected to occur at least once during the replay phase</li>
<li>they may occur more than once, though, and in a different order relative to other recorded expectations</li>
<li>additionally, invocations that don’t match any recorded expectation are allowed to occur in any number and in any order. </li>
</ul>
          <div class="post-more-link text-center">
            <a class="btn" href="/2016/04/25/test/jmockit/Unit-Test-JMockit-Difference-between-Expectations-NonStrictExpectations-and-StrictExpectations/#more" rel="contents">
              Read more &raquo;
            </a>
          </div>
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/04/20/java/concurrency/Java-Concurrency-ReentrantLock/" itemprop="url">
                  Java Concurrency - ReentrantLock
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">Posted on</span>
            <time itemprop="dateCreated" datetime="2016-04-20T22:51:31+08:00" content="2016-04-20">
              2016-04-20
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">In</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/java/" itemprop="url" rel="index">
                    <span itemprop="name">java</span>
                  </a>
                </span>

                
                
                  , 
                

              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/java/concurrency/" itemprop="url" rel="index">
                    <span itemprop="name">concurrency</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2016/04/20/java/concurrency/Java-Concurrency-ReentrantLock/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2016/04/20/java/concurrency/Java-Concurrency-ReentrantLock/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          <h1 id="Motivation"><a href="#Motivation" class="headerlink" title="Motivation"></a>Motivation</h1><p>Java’s <code>synchronized</code> keyword is a wonderful tool – it allows us a simple and reliable way to synchronize access to critical sections and it’s not too hard to understand.</p>
<p>But sometimes we need more control over synchronization. Either we need to control types of access (read and write) separately, or it is cumbersome to use because either there is no obvious mutex or we need to maintain multiple mutexes.</p>
<p>Thankfully, lock utility classes make these problems easier to solve.</p>
<h2 id="1-Lock-interface"><a href="#1-Lock-interface" class="headerlink" title="1 Lock interface"></a>1 Lock interface</h2><p><code>Lock</code> implementations provide more extensive locking operations than can be obtained using <code>synchronized</code> methods and statements. They allow more flexible structuring, may have quite different properties, and may support multiple associated <code>Condition</code> objects.</p>
<p>A lock is a tool for controlling access to a shared resource by multiple threads. Commonly, a lock provides exclusive access to a shared resource: only one thread at a time can acquire the lock and all access to the shared resource requires that the lock be acquired first. However, some locks may allow concurrent access to a shared resource, such as the read lock of a <code>ReadWriteLock</code>.</p>
<p>The use of synchronized methods or statements provides access to the implicit monitor lock associated with every object, but forces all lock acquisition and release to occur in a block-structured way: when multiple locks are acquired they must be released in the opposite order, and all locks must be released in the same lexical scope in which they were acquired.</p>
          <div class="post-more-link text-center">
            <a class="btn" href="/2016/04/20/java/concurrency/Java-Concurrency-ReentrantLock/#more" rel="contents">
              Read more &raquo;
            </a>
          </div>
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/04/20/java/concurrency/Java-Concurrency-Callable-Future-and-FutureTask/" itemprop="url">
                  Java Concurrency - Callable, Future, and FutureTask
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">Posted on</span>
            <time itemprop="dateCreated" datetime="2016-04-20T21:51:31+08:00" content="2016-04-20">
              2016-04-20
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">In</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/java/" itemprop="url" rel="index">
                    <span itemprop="name">java</span>
                  </a>
                </span>

                
                
                  , 
                

              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/java/concurrency/" itemprop="url" rel="index">
                    <span itemprop="name">concurrency</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2016/04/20/java/concurrency/Java-Concurrency-Callable-Future-and-FutureTask/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2016/04/20/java/concurrency/Java-Concurrency-Callable-Future-and-FutureTask/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          <h1 id="1-Motivation-Drawbacks-of-Thread-and-Runnable"><a href="#1-Motivation-Drawbacks-of-Thread-and-Runnable" class="headerlink" title="1 Motivation: Drawbacks of Thread and Runnable"></a>1 Motivation: Drawbacks of Thread and Runnable</h1><p>One of the beautiful things about Java from its very first release was the ease with which we could write multi-threaded programs and introduce asynchronous processing into our designs. The <code>Thread</code> class and <code>Runnable</code> interface combined with Java’s memory management model meant for straightforward thread programming.</p>
<blockquote>
<p>But neither the <code>Thread</code> class nor the <code>Runnable</code> interface allowed for thrown Exceptions or returned values. The lack of returned values was mildly annoying.</p>
</blockquote>
<p>The lack of thrown checked exceptions was a little more serious. The contract was <code>public void run()</code> which meant you had to catch checked exceptions and do something with them. Even if you were careful and you stored these for later verification, you couldn’t force all uses of the class to check the exception. You could go through all your getters and throw the <code>Exception</code> if it existed on each one. Besides being cumbersome, even that wasn’t foolproof. You couldn’t enforce calls to any of these. Thread programmers would correctly call <code>join()</code> to wait for it complete and may then have gone on their merry way.</p>
<p>With the introduction of the <code>Callable</code> and <code>Future</code> interfaces and their support in the thread pools, both of these issues have been addressed quite elegantly.</p>
<h1 id="2-Callable-lt-V-gt-interface"><a href="#2-Callable-lt-V-gt-interface" class="headerlink" title="2 Callable&lt;V&gt; interface"></a>2 <code>Callable&lt;V&gt;</code> interface</h1><p>A task that returns a result and may throw an exception. Implementors define a single method with no arguments called <code>public T call() throws Exception</code>. Now we can return a result, have it strongly typed as declared in our implementation and even throw <code>Exceptions</code>. </p>
<p>The <code>Callable</code> interface is similar to <code>Runnable</code>, in that both are designed for classes whose instances are potentially executed by another thread. A <code>Runnable</code>, however, does not return a result and cannot throw a checked exception.</p>
<p>The <code>Executors</code> class contains utility methods to convert from other common forms (like <code>Runnable</code>) to <code>Callable</code> classes, however you would do well to review your current implementations of <code>Runnable</code> or subclasses of <code>Thread</code>. Why bother? Primarily to double check and remove the workaround you may have implemented to address the lack of support for thrown <code>Exceptions</code>. At the same time, you may wish to make use of the ability to return results right in the execution method eliminating any need to cast to retrieve values.</p>
          <div class="post-more-link text-center">
            <a class="btn" href="/2016/04/20/java/concurrency/Java-Concurrency-Callable-Future-and-FutureTask/#more" rel="contents">
              Read more &raquo;
            </a>
          </div>
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/2/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="/">1</a><a class="page-number" href="/page/2/">2</a><span class="page-number current">3</span><a class="page-number" href="/page/4/">4</a><span class="space">&hellip;</span><a class="page-number" href="/page/6/">6</a><a class="extend next" rel="next" href="/page/4/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      

      <section class="site-overview sidebar-panel  sidebar-panel-active ">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/avatar/avatar.jpg"
               alt="Bowen" />
          <p class="site-author-name" itemprop="name">Bowen</p>
          <p class="site-description motion-element" itemprop="description">keep learning - learning notes and blogs</p>
        </div>
        <nav class="site-state motion-element">
          <div class="site-state-item site-state-posts">
            <a href="https://phoenixjiangnan.github.io/archives">
              <span class="site-state-item-count">107</span>
              <span class="site-state-item-name">posts</span>
            </a>
          </div>

          
            <div class="site-state-item site-state-categories">
              <a href="https://phoenixjiangnan.github.io/categories">
                <span class="site-state-item-count">48</span>
                <span class="site-state-item-name">categories</span>
              </a>
            </div>
          

          
            <div class="site-state-item site-state-tags">
              <a href="https://phoenixjiangnan.github.io/tags">
                <span class="site-state-item-count">255</span>
                <span class="site-state-item-name">tags</span>
              </a>
            </div>
          

        </nav>

        
          <div class="feed-link motion-element">
            <a href="/atom.xml" rel="alternate">
              <i class="fa fa-rss"></i>
              RSS
            </a>
          </div>
        

        <div class="links-of-author motion-element">
          
        </div>

        
        

        
        

      </section>

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy; 
  <span itemprop="copyrightYear">2016</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Bowen</span>
</div>

<div class="powered-by">
  Powered by <a class="theme-link" href="https://hexo.io">Hexo</a>
</div>

<div class="theme-info">
  Theme -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Muse
  </a>
</div>

        

        
      </div>
    </footer>

    <div class="back-to-top">
      <i class="fa fa-arrow-up"></i>
    </div>
  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  



  
  <script type="text/javascript" src="/vendors/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/vendors/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/vendors/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/vendors/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/vendors/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/vendors/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.0.1"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.0.1"></script>



  
  

  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.0.1"></script>



  



  

    <script type="text/javascript">
      var disqus_shortname = 'bowensgithubblog';
      var disqus_identifier = 'page/3/index.html';
      var disqus_title = "";
      var disqus_url = '';

      function run_disqus_script(disqus_script){
        var dsq = document.createElement('script');
        dsq.type = 'text/javascript';
        dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/' + disqus_script;
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
      }

      run_disqus_script('count.js');
      
    </script>
  




  
  
  <script type="text/javascript">
    // Popup Window;
    var isfetched = false;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length == 0) {
       search_path = "search.xml";
    }
    var path = "/" + search_path;
    // monitor main search box;

    function proceedsearch() {
      $("body").append('<div class="popoverlay">').css('overflow', 'hidden');
      $('.popup').toggle();

    }
    // search function;
    var searchFunc = function(path, search_id, content_id) {
    'use strict';
    $.ajax({
        url: path,
        dataType: "xml",
        async: true,
        success: function( xmlResponse ) {
            // get the contents from search data
            isfetched = true;
            $('.popup').detach().appendTo('.header-inner');
            var datas = $( "entry", xmlResponse ).map(function() {
                return {
                    title: $( "title", this ).text(),
                    content: $("content",this).text(),
                    url: $( "url" , this).text()
                };
            }).get();
            var $input = document.getElementById(search_id);
            var $resultContent = document.getElementById(content_id);
            $input.addEventListener('input', function(){
                var matchcounts = 0;
                var str='<ul class=\"search-result-list\">';
                var keywords = this.value.trim().toLowerCase().split(/[\s\-]+/);
                $resultContent.innerHTML = "";
                if (this.value.trim().length > 1) {
                // perform local searching
                datas.forEach(function(data) {
                    var isMatch = true;
                    var content_index = [];
                    var data_title = data.title.trim().toLowerCase();
                    var data_content = data.content.trim().replace(/<[^>]+>/g,"").toLowerCase();
                    var data_url = data.url;
                    var index_title = -1;
                    var index_content = -1;
                    var first_occur = -1;
                    // only match artiles with not empty titles and contents
                    if(data_title != '' && data_content != '') {
                        keywords.forEach(function(keyword, i) {
                            index_title = data_title.indexOf(keyword);
                            index_content = data_content.indexOf(keyword);
                            if( index_title < 0 && index_content < 0 ){
                                isMatch = false;
                            } else {
                                if (index_content < 0) {
                                    index_content = 0;
                                }
                                if (i == 0) {
                                    first_occur = index_content;
                                }
                            }
                        });
                    }
                    // show search results
                    if (isMatch) {
                        matchcounts += 1;
                        str += "<li><a href='"+ data_url +"' class='search-result-title'>"+ data_title +"</a>";
                        var content = data.content.trim().replace(/<[^>]+>/g,"");
                        if (first_occur >= 0) {
                            // cut out 100 characters
                            var start = first_occur - 20;
                            var end = first_occur + 80;
                            if(start < 0){
                                start = 0;
                            }
                            if(start == 0){
                                end = 50;
                            }
                            if(end > content.length){
                                end = content.length;
                            }
                            var match_content = content.substring(start, end);
                            // highlight all keywords
                            keywords.forEach(function(keyword){
                                var regS = new RegExp(keyword, "gi");
                                match_content = match_content.replace(regS, "<b class=\"search-keyword\">"+keyword+"</b>");
                            });

                            str += "<p class=\"search-result\">" + match_content +"...</p>"
                        }
                        str += "</li>";
                    }
                })};
                str += "</ul>";
                if (matchcounts == 0) { str = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>' }
                if (keywords == "") { str = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>' }
                $resultContent.innerHTML = str;
            });
            proceedsearch();
        }
    });}

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched == false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };

    });

    $('.popup-btn-close').click(function(e){
      $('.popup').hide();
      $(".popoverlay").remove();
      $('body').css('overflow', '');
    });
    $('.popup').click(function(e){
      e.stopPropagation();
    });
  </script>


  

  

  

</body>
</html>
